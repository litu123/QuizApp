let exams = {
    process: [
        {
            question: "Availability of services in the contract generally refers to",
            options: ["Infrastructure and Application", "Infrastructure only", "Application only", "Database Only"],
            answer: [0],
            type: "single"
        },
        {
            question: "Which portion of information is more likely to be found in a Service Level Agreement?",
            options: [
                "Service Contract Credit Calculations and Service Level Reporting Frequency", 
                "Service Level Exception Calculation Process and Revised SLA Calculation Logic", 
                "Assumptions and Challenges in achieving agreed Service Levels", 
                "Source Data Extraction Logic and SLA Calculation Logic"
            ],
            answer: [0],
            type: "single"
        },
        {
            question: "In the middle of the Sprint, developers find that a few more days of work is needed to complete the scope. The planning options include:",
            options: [
                "Add more team members", 
                "Catch up using Weekends", 
                "Involve the Product Owner and negotiate alternatives", 
                "Defer the activities such as testing to be taken up after the Sprint Review"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "How can we resolve the issues with incumbent vendor?",
            options: [
                "Escalate it to the supervisor in vendor hierarchy", 
                "Adjust and learn without making a big issue", 
                "Enable transition governance with TCS, customer, and incumbent vendor", 
                "Build friendship with incumbent vendor"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "A practice which reviews potential challenges and customer dependencies in managing IT Operations by addressing it with right stakeholders.",
            options: [
                "Knowledge Management", 
                "Risk Management", 
                "Automation", 
                "Service Level Management"
            ],
            answer: [1],
            type: "single"
        },
        {
            question: "Best approach to execute a change without a documented SOP.",
            options: [
                "Have app team write SOP", 
                "Document plan, execute with SME guidance", 
                "Have vendor write instructions", 
                "Document plan, get SOP approval before execution"
            ],
            answer: [1],
            type: "single"
        },
        {
            question: "What can be suggested for a team with a frequently changing Product Owner vision?",
            options: [
                "Escalate to Head of Business Function", 
                "Apply waterfall method", 
                "Adopt practices from Extreme Programming", 
                "Apply design thinking first, then Agile"
            ],
            answer: [3],
            type: "single"
        },
        {
            question: "What should be done to reduce or remove alerts?",
            options: [
                "Perform trend analysis", 
                "Differentiate alerts for critical applications", 
                "Review alerts regularly", 
                "All of the above"
            ],
            answer: [3],
            type: "single"
        },
        {
            question: "Standard way for Delivery Partner to get project status updates.",
            options: [
                "Daily email updates from team", 
                "Daily individual check-ins", 
                "Refer to team Kanban board", 
                "Schedule status review meetings"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "Role of a functional manager in Scrum?",
            options: [
                "Provide functional requirements", 
                "Assign people to teams", 
                "Monitor productivity", 
                "None of these"
            ],
            answer: [3],
            type: "single"
        },
        {
            question: "Best suited option for regular scheduled/special batch jobs.",
            options: ["Induction Manual", "Use Case", "Run book", "SOP"],
            answer: [2],
            type: "single"
        },
        {
            question: "Who should a customer talk to for important product communication?",
            options: [
                "Development Team only", 
                "Meet with all team members", 
                "Product Owner only", 
                "Scrum Master only"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "An incident with impact between a normal incident and a disaster is termed as",
            options: ["Normal Change", "Service Request", "Major Incident", "Standard Process"],
            answer: [2],
            type: "single"
        },
        {
            question: "What could have mitigated a disk space issue due to failed batch process?",
            options: [
                "Training on batch job restart", 
                "Monitor critical parameters and set alerts", 
                "Shift Management", 
                "Knowledge articles on batch restart"
            ],
            answer: [1],
            type: "single"
        },
        {
            question: "Recommended estimation method in Scrum?",
            options: ["T-Shirt sizing", "Function Points", "Planning Poker", "None of the above"],
            answer: [2],
            type: "single"
        },
        {
            question: "Changes without adequate lead time as per policies are called",
            options: ["Expedited", "Emergency", "Major", "Retrofit"],
            answer: [0],
            type: "single"
        },
        {
            question: "Primary focus of a Scrum Master is",
            options: [
                "Being new for fresh perspective", 
                "Assertive communication", 
                "Removing team impediments", 
                "Experience with new technologies"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "Who is primarily responsible for change categorization?",
            options: ["Change Manager", "Incident Manager", "Tower Lead", "None of the above"],
            answer: [0],
            type: "single"
        },
        {
            question: "What is the purpose of Service Request Management?",
            options: [
                "Resolve root cause of incidents", 
                "Monitor critical parameters", 
                "Handle requests like password resets", 
                "Manage system configurations"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "Ensuring stability and availability in the contract generally refers to",
            options: ["Change Management", "Incident Management", "Problem Management", "Service Management"],
            answer: [3],
            type: "single"
        },
        {
            question: "A customer is experiencing consistent service outages. The best course of action is:",
            options: [
                "Conduct an RCA (Root Cause Analysis)", 
                "Initiate Incident Management", 
                "Assign more staff for immediate resolution", 
                "Schedule regular maintenance checks"
            ],
            answer: [0],
            type: "single"
        },
        {
            question: "A project has gone past the deadline. Which action is best?",
            options: [
                "Assign more resources", 
                "Request a deadline extension", 
                "Prioritize critical tasks with stakeholders", 
                "Work overtime to complete"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "The main objective of Incident Management is to",
            options: [
                "Manage customer communications", 
                "Identify root causes", 
                "Restore service as soon as possible", 
                "Document all incidents"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "A product that doesnâ€™t meet customer needs leads to",
            options: [
                "Decreased revenue", 
                "Customer churn", 
                "Higher operational costs", 
                "All of the above"
            ],
            answer: [3],
            type: "single"
        },
        {
            question: "High-level document outlining project goals, budget, and timeline is",
            options: ["Scope Document", "Project Charter", "Milestone Plan", "Project Plan"],
            answer: [1],
            type: "single"
        },
        {
            question: "A project's initial phase involves",
            options: [
                "Implementing the plan", 
                "Collecting requirements", 
                "Defining project charter", 
                "Managing resources"
            ],
            answer: [2],
            type: "single"
        },
        {
            question: "The method where customer needs are continuously integrated into product features",
            options: ["Waterfall", "Agile", "Lean", "Six Sigma"],
            answer: [1],
            type: "single"
        },
        {
            question: "Project risks should be",
            options: [
                "Logged and monitored", 
                "Delegated to a specific team", 
                "Ignored until a problem arises", 
                "Reviewed only at project end"
            ],
            answer: [0],
            type: "single"
        },
        {
            question: "Deliverables should be",
            options: [
                "Only presented at project end", 
                "Shared regularly with stakeholders", 
                "Kept confidential until complete", 
                "Verified by third-party vendor"
            ],
            answer: [1],
            type: "single"
        },
        {
            question: "When project scope changes frequently, the best approach is",
            options: [
                "Add resources to manage change", 
                "Request fixed requirements", 
                "Implement Change Management processes", 
                "Proceed without adapting"
            ],
            answer: [2],
            type: "single"
        }
    ],
    articulation: [
        {
            question: "Which country is known as the Land of the Rising Sun?",
            options: ["Japan", "China", "Thailand", "India"],
            answer: [0],
            type: "single"
        },
        {
            question: "Which continents are fully in the Northern Hemisphere?",
            options: ["Asia", "Australia", "North America", "Africa"],
            answer: [0, 2],
            type: "multiple"
        }
    ]
};

let selectedExam = [];
let currentQuestionIndex = 0;
let userAnswers = [];
let currentExamKey = "";

function loadExams() {
    const examButtonsDiv = document.getElementById("examButtons");
    examButtonsDiv.innerHTML = "";

    for (const examKey in exams) {
        const button = document.createElement("button");
        button.innerText = examKey.replace(/([A-Z])/g, " $1"); // Format exam key nicely
        button.onclick = () => selectExam(examKey);
        examButtonsDiv.appendChild(button);
    }
}

function selectExam(examKey) {
    currentExamKey = examKey;
    selectedExam = exams[examKey];
    
    document.getElementById("examSelection").style.display = "none";
    document.getElementById("examDescription").style.display = "block";
    document.getElementById("examTitle").innerText = examKey.replace(/([A-Z])/g, " $1");
    document.getElementById("examQuestions").innerText = `Number of Questions: ${selectedExam.length}`;
}

function proceedToTest() {
    document.getElementById("examDescription").style.display = "none";
    document.getElementById("examPage").style.display = "flex";
    startTimer();
    loadQuestion(0);
}

function startTimer() {
    let duration = 3600;
    const timerElement = document.getElementById("timer");

    const timerInterval = setInterval(() => {
        const minutes = Math.floor(duration / 60);
        const seconds = duration % 60;
        timerElement.innerText = `${minutes}:${seconds.toString().padStart(2, "0")}`;
        duration--;

        if (duration < 0) {
            clearInterval(timerInterval);
            showResult();
        }
    }, 1000);
}

function loadQuestion(index) {
    currentQuestionIndex = index;
    const question = selectedExam[index];
    document.getElementById("questionText").innerText = question.question;
    document.getElementById("questionType").innerText = question.type === "single" ? "Single Choice" : "Multiple Choice";
    
    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";
    question.options.forEach((option, i) => {
        const optionWrapper = document.createElement("label");

        const optionElement = document.createElement("input");
        optionElement.type = question.type === "single" ? "radio" : "checkbox";
        optionElement.name = "option";
        optionElement.value = i;
        optionElement.onclick = () => selectOption(i);

        optionWrapper.appendChild(optionElement);
        optionWrapper.append(option);
        optionsDiv.appendChild(optionWrapper);
    });

    updateNavigation();
}

function selectOption(optionIndex) {
    const question = selectedExam[currentQuestionIndex];
    userAnswers[currentQuestionIndex] = userAnswers[currentQuestionIndex] || [];

    if (question.type === "single") {
        userAnswers[currentQuestionIndex] = [optionIndex];
    } else {
        const optionPos = userAnswers[currentQuestionIndex].indexOf(optionIndex);
        if (optionPos === -1) userAnswers[currentQuestionIndex].push(optionIndex);
        else userAnswers[currentQuestionIndex].splice(optionPos, 1);
    }
}

function submitAndNext() {
    markAnswered(currentQuestionIndex);
    if (currentQuestionIndex < selectedExam.length - 1) {
        loadQuestion(currentQuestionIndex + 1);
    } else {
        showResult();
    }
}

function markAnswered(index) {
    const button = document.getElementById(`question-${index}`);
    button.classList.remove("unanswered");
    button.classList.add("answered");
}

function updateNavigation() {
    const questionButtonsDiv = document.getElementById("questionButtons");
    questionButtonsDiv.innerHTML = "";

    selectedExam.forEach((_, i) => {
        const button = document.createElement("button");
        button.id = `question-${i}`;
        button.className = userAnswers[i] ? "answered" : "unanswered";
        button.innerText = i + 1;
        button.onclick = () => loadQuestion(i);
        questionButtonsDiv.appendChild(button);
    });
}

function showResult() {
    document.getElementById("examPage").style.display = "none";
    document.getElementById("resultPage").style.display = "block";

    let score = 0;
    const resultDetails = document.getElementById("detailedResult");
    resultDetails.innerHTML = "";

    selectedExam.forEach((question, i) => {
        const userAnswer = userAnswers[i] || [];
        const correct = JSON.stringify(userAnswer.sort()) === JSON.stringify(question.answer.sort());

        if (correct) score++;
        const resultText = document.createElement("p");
        resultText.className = correct ? "correct" : "incorrect";
        resultText.innerHTML = `Q${i + 1}: ${question.question}<br>Your Answer: ${userAnswer.map(ans => question.options[ans]).join(", ") || "None"}<br>Correct Answer: ${question.answer.map(ans => question.options[ans]).join(", ")}`;
        resultDetails.appendChild(resultText);
    });

    document.getElementById("resultText").innerText = `Your score: ${score} / ${selectedExam.length}`;
}

function restartExam() {
    document.getElementById("resultPage").style.display = "none";
    document.getElementById("examSelection").style.display = "block";
    
    // Reset quiz variables
    selectedExam = [];
    currentQuestionIndex = 0;
    userAnswers = [];
    currentExamKey = "";

    loadExams();  // Reload exam selection
}


// Initialize the exam selection on page load
window.onload = loadExams;
